<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.springframework.org/schema/beans
           http://www.springframework.org/schema/beans/spring-beans-3.0.xsd">

   <bean id="schedulerFactory" class="org.smallmind.scheduling.quartz.spring.SpringSchedulerFactory">
      <constructor-arg index="0">
         <props>
            <prop key="org.quartz.scheduler.instanceName">Scheduler</prop>
            <prop key="org.quartz.scheduler.instanceId">AUTO</prop>
            <prop key="org.quartz.scheduler.threadsInheritContextClassLoaderOfInitializer">true</prop>
            <prop key="org.quartz.threadPool.class">org.quartz.simpl.SimpleThreadPool</prop>
            <prop key="org.quartz.threadPool.threadCount">10</prop>
            <prop key="org.quartz.scheduler.rmi.export">true</prop>
            <prop key="org.quartz.scheduler.rmi.createRegistry">as_needed</prop>
            <prop key="org.quartz.jobStore.class">org.quartz.impl.jdbcjobstore.JobStoreTX</prop>
            <prop key="org.quartz.jobStore.driverDelegateClass">org.quartz.impl.jdbcjobstore.MSSQLDelegate</prop>
            <prop key="org.quartz.jobStore.dataSource">dsOne</prop>
            <prop key="org.quartz.jobStore.tablePrefix">QRTZ_</prop>
            <prop key="org.quartz.jobStore.useProperties">true</prop>
            <prop key="org.quartz.jobStore.isClustered">false</prop>
            <prop key="org.quartz.dataSource.dsOne.driver">${jdbc.driver.classname}</prop>
            <prop key="org.quartz.dataSource.dsOne.URL">${jdbc.url.quartz}</prop>
            <prop key="org.quartz.dataSource.dsOne.user">${db.username}</prop>
            <prop key="org.quartz.dataSource.dsOne.password">${db.password}</prop>
            <prop key="org.quartz.dataSource.dsOne.validationQuery">select 1</prop>
         </props>
      </constructor-arg>
   </bean>

   <bean id="scheduler" factory-bean="schedulerFactory" factory-method="getScheduler" init-method="start" destroy-method="shutdown"/>

   <bean id="group.nameDetail" class="org.quartz.JobDetail">
      <property name="description" value="Description of detail"/>
      <property name="group" value="group"/>
      <property name="name" value="nameJob"/>
      <property name="jobClass" value="jobClass"/>
      <property name="durability" value="true"/>
      <property name="volatility" value="true"/>
      <property name="requestsRecovery" value="false"/>
   </bean>

   <bean id="group.nameTrigger" class="org.quartz.CronTrigger">
      <property name="description" value="Run every 10 minutes"/>
      <property name="group" value="group"/>
      <property name="name" value="nameTrigger"/>
      <property name="jobGroup" value="group"/>
      <property name="jobName" value="nameJob"/>
      <property name="cronExpression" value="0 0/10 * * * ?"/>
      <property name="volatility" value="false"/>
   </bean>

   <bean id="group.nameJob" class="jobClass" scope="prototype"/>

   <bean class="org.smallmind.scheduling.quartz.spring.CronJobInitializingBean">
      <property name="scheduler" ref="scheduler"/>
      <property name="jobMap">
         <map>
            <entry key-ref="group.nameDetail">
               <list>
                  <ref bean="group.nameTrigger"/>
               </list>
            </entry>
         </map>
      </property>
   </bean>

</beans>